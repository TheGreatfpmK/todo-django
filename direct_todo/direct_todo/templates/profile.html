{% extends "site_base.html" %}
{% block extra_header %}
<script>
$(document).ready(function(){
    $(".datefield").datepicker()
});
function delete_task(task){
    var msg = $.ajax({
                url:"/profile/delete-task/"+task+"/",
                success: function(){
                    $("#task-"+task).fadeOut(500);                    
                    }
                });    
}
function add_task(){
    title=$("#newtask-title").val();
    tags=$("#newtask-tags").val();
    date=$("#newtask-date").val();
    var new_task = $.ajax({
                     url:"/profile/add-task/",
                     data:"title="+title+"&date="+date+"&tags="+tags,
                     success: function(){
                        
                        }
                   });
}
</script>
{% endblock extra_header %}
{% block body %}
<section><div class="section subpage">
    <div class="wrapper">    
        <div class="row">
            <div class="span12">
            <h1>{{user}}'s Tasks</h1>
            </div>
        </div>
        <div class="row">
            <div class="span8">
                <table class="table table-striped table-bordered">
                <tr>
                    <th>Task</th><th>Due Date</th><th colspan="2">Tags</th>
                </tr>
                {% for task in tasks %}
                    <tr id="task-{{task.id}}">
                    <td>
                        <b>{{task.title}}</b>
                    </td><td>
                        {{task.due_date}}
                    </td><td> 
                    {% for tag in task.tags.all %}
                        <span class="btn">{{tag}}</span>
                    {%endfor%}
                    </td><td>
                    <button onclick="delete_task('{{task.id}}');" class="btn">Done</button>
                    </td></tr>
                {% endfor %}
                </table>              
            </div>
            <div class="span4">                
                <div class="formBox">                
                    <b>Add task</b>
                    <form onsubmit="add_task();return false;" class="form-inline">
                    <div>
                        <input type="text" placeholder="Title" id="newtask-title"/>
                    </div><div>
                        <input type="text" class="datefield" placeholder="Date" id="newtask-date"/>
                    </div><div>
                        <input type="text" placeholder="Tags (tag,tag,tag)" id="newtask-tags"/>
                    </div><div>                    
                        <input type="submit" class="btn" value="save" id="newtask-submit"/>
                    </div>
                    </form>
                </div>
                                
            </div>
        </div>
    </div>
</div></section>
{% endblock body %}
